/* ===== Base palette (Gruvbox Dark as defaults) ===== */
/* ===== Shared improvements ===== */
:root {
    /* Useful extras */
    --link: var(--accent);
    --link-hover: var(--accent-2);
    --focus: color-mix(in oklab, var(--accent) 70%, white);
    --selection: color-mix(in oklab, var(--accent) 25%, transparent);
    --code-bg: color-mix(in oklab, var(--bg-0) 85%, black);
    --code-edge: color-mix(in oklab, var(--edge) 80%, black);

    /* Make borders subtle & consistent */
    --edge: color-mix(in oklab, var(--edge) 85%, var(--bg-0));
}

/* ===== Gruvbox (keep, minor polish) ===== */
html[data-theme="gruvbox-dark"] {
    --bg-0: #1d2021;
    --bg-1: #242726;
    /* + subtle lift */
    --panel: #2b2e2d;
    --edge: #3a3d3c;
    --ink: #ebdbb2;
    --muted: #b3a78f;
    --accent: #8ec07c;
    /* aqua */
    --accent-2: #b8bb26;
    /* green */
    --chip: #2b2e2d;
    --row: #252624;
}

/* ===== Oxocarbon (less plastic, better contrast) ===== */
html[data-theme="oxocarbon"] {
    --bg-0: #161616;
    --bg-1: #1e1e1e;
    /* lift ~4–5% */
    --panel: #262626;
    --edge: #343434;
    --ink: #e8ebf0;
    /* softer than pure white */
    --muted: #b8bec8;
    --accent: #12bdb7;
    /* slightly less neon */
    --accent-2: #6aa6ff;
    --ok: #42be65;
    --warn: #ffb454;
    /* warmer, clearer warning */
    --bad: #ff6b6b;
    --chip: #202020;
    --row: #1c1c1c;
}

/* ===== “uwu” (was muddy → clearer steps & calmer accents) ===== */
html[data-theme="uwu"] {
    --bg-0: #2b2730;
    --bg-1: #35313a;
    --panel: #3f3b44;
    --edge: #4c4751;
    --ink: #f2f1f4;
    /* off-white */
    --muted: #b0acb6;
    --accent: #e05a9d;
    /* less harsh magenta */
    --accent-2: #b58af0;
    /* lavender */
    --ok: #21b79e;
    --warn: #e2a64b;
    --bad: #e05a9d;
    --chip: #3a3540;
    --row: #332f38;
}

/* ===== Solarized Dark (respect palette, fix brightness & steps) ===== */
/* Solarized Dark — contrast boost */
/* Solarized Dark — punchier contrast */
html[data-theme="solarized-dark"] {
    /* darker steps */
    --bg-0: #00161b;
    /* deeper than base03 */
    --bg-1: #012028;
    --panel: #072d38;
    --edge: #264750;

    /* brighter, warmer ink = more pop on cyan-ish bg */
    --ink: #fff7e6;
    /* near-white w/ warm tint */
    --muted: #cfd7cf;
    /* clearer secondary */

    /* accents unchanged, but errors a touch brighter */
    --accent: #2aa198;
    --accent-2: #8fb400;
    --ok: #8fb400;
    --warn: #d8a100;
    --bad: #ff5a4f;

    --chip: #08323e;
    --row: #0a3240;
}

/* ensure text actually uses the ink and reads crisply */
html[data-theme="solarized-dark"] body {
    color: var(--ink);
    text-rendering: optimizeLegibility;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    line-height: 1.55;
}

/* ===== GitHub Dark (reduce muddiness, lift text, clearer rows) ===== */
html[data-theme="github-dark"] {
    --bg-0: #0d1117;
    --bg-1: #121821;
    --panel: #161b22;
    --edge: #2a313a;
    --ink: #d5dbe3;
    /* brighter text */
    --muted: #9aa3ad;
    --accent: #6aa8ff;
    /* slightly lighter */
    --accent-2: #3fbf63;
    --ok: #3fbf63;
    --warn: #e0ad3b;
    --bad: #ff6e6a;
    --chip: #1b212b;
    --row: #121820;
}

/* ===== Suggested component hooks (optional) ===== */
a {
    color: var(--link);
}

a:hover {
    color: var(--link-hover);
}

:focus-visible {
    outline: 2px solid var(--focus);
    outline-offset: 2px;
}

::selection {
    background: var(--selection);
}

code,
pre {
    background: var(--code-bg);
    border: 1px solid var(--code-edge);
}

/* ===== Base ===== */
* {
    box-sizing: border-box
}

html,
body {
    height: 100%;
    width: 100%;
    overflow-x: hidden;
}

body {
    margin: 0;
    color: var(--ink);
    background:
        linear-gradient(0deg, transparent 24%, rgba(235, 219, 178, .04) 25%, rgba(235, 219, 178, .04) 26%, transparent 27%, transparent 74%, rgba(235, 219, 178, .04) 75%, rgba(235, 219, 178, .04) 76%, transparent 77%),
        linear-gradient(90deg, transparent 24%, rgba(235, 219, 178, .035) 25%, rgba(235, 219, 178, .035) 26%, transparent 27%, transparent 74%, rgba(235, 219, 178, .035) 75%, rgba(235, 219, 178, .035) 76%, transparent 77%),
        radial-gradient(1200px 720px at 12% -10%, rgba(255, 255, 255, .05) 0%, transparent 55%),
        radial-gradient(900px 600px at 120% 12%, rgba(255, 255, 255, .04) 0%, transparent 55%),
        var(--bg-0);
    background-size: 32px 32px, 32px 32px, auto, auto, auto;
    font: 14px/1.6 ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, Helvetica, Arial, "Noto Sans", "Apple Color Emoji", "Segoe UI Emoji";
    letter-spacing: .01em;
}

body::before {
    content: "";
    position: fixed;
    inset: 0;
    pointer-events: none;
    background: radial-gradient(1600px 1000px at -20% -20%, rgba(235, 219, 178, .04), transparent 60%),
        repeating-linear-gradient(0deg, rgba(235, 219, 178, .03) 0 1px, transparent 1px 2px);
    mix-blend-mode: overlay;
    opacity: .9;
}

/* Layout */
.app {
    margin: 0 auto;
    padding: 18px;
    width: clamp(75vw, 92vw, 1600px);
}

.topbar {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 16px;
    padding: 10px 14px;
    background: var(--bg-1);
    border: 1px solid var(--edge);
    border-radius: 12px;
    flex-wrap: wrap;
    /* allow wrap on narrow screens */
}

.brand {
    display: flex;
    align-items: center;
    gap: 12px
}

.logo {
    width: 36px;
    height: 36px;
    object-fit: contain;
    border-radius: 6px;
    background: #1a1b19
}

.brand h1 {
    margin: 0;
    font-size: 14px;
    letter-spacing: .18em;
    text-transform: uppercase
}

.brand .sub {
    color: var(--muted);
    font-size: 11px;
    letter-spacing: .16em;
    text-transform: uppercase
}

.nav {
    display: flex;
    align-items: center;
    gap: 12px;
    flex-wrap: wrap
}

.nav a {
    color: var(--muted);
    text-decoration: none;
    font-size: 12px;
    letter-spacing: .12em;
    text-transform: uppercase;
    padding: 6px 10px;
    border-radius: 8px
}

.nav a:hover {
    color: var(--ink);
    background: rgba(142, 192, 124, .12)
}

.theme-select {
    min-width: 170px
}

.grid {
    display: grid;
    grid-template-columns: 260px minmax(0, 1fr) 300px;
    gap: 16px;
    margin-top: 16px
}

.panel {
    background: var(--panel);
    border: 1px solid var(--edge);
    border-radius: 12px
}

.panel .hd {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 10px 12px;
    border-bottom: 1px solid var(--edge);
    font-weight: 700;
    letter-spacing: .12em;
    text-transform: uppercase;
    font-size: 12px;
    color: var(--muted)
}

.panel .bd {
    padding: 12px
}

/* chips / tags */
.chips {
    display: flex;
    flex-wrap: wrap;
    gap: 8px
}

.chip {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    background: var(--chip);
    border: 1px solid var(--edge);
    color: var(--ink);
    padding: 6px 10px;
    border-radius: 999px;
    cursor: pointer;
    user-select: none;
    font-size: 12px
}

.chip .dot {
    width: 8px;
    height: 8px;
    border-radius: 50%;
    background: var(--accent);
    box-shadow: 0 0 0 2px rgba(142, 192, 124, .15)
}

.chip.active {
    outline: 2px solid rgba(142, 192, 124, .35);
    background: rgba(142, 192, 124, .08)
}

.tag {
    background: var(--chip);
    border: 1px solid var(--edge);
    color: var(--ink);
    border-radius: 6px;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    padding: 4px 10px;
    line-height: 1;
    vertical-align: middle;
    font-size: var(--fs-1);
}

/* Landing page table: make tag chips small like author pills */
.events td.col-tags .tag {
    font-size: 11px;
    /* match .pill */
    line-height: 1.1;
    /* match .pill */
    padding: 2px 8px;
    /* match .pill */
    border-radius: 999px;
}

.tags {
    display: flex;
    flex-wrap: wrap;
    gap: 6px
}

/* TAGS column fixed width (in ch) */
#col-tags {
    width: calc(var(--tags-col-ch, 20) * 1ch);
    /* default 20ch; overrideable */
    max-width: calc(var(--tags-col-ch, 20) * 1ch);
}

/* Landing page table: make tag chips small like author pills */
.events td.col-tags .tag {
    font-size: 11px;
    /* match .pill */
    line-height: 1.1;
    /* match .pill */
    padding: 2px 8px;
    /* match .pill */
    border-radius: 999px;
}


.pill {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    padding: 2px 8px;
    border-radius: 999px;
    background: rgba(142, 192, 124, .12);
    border: 1px solid rgba(142, 192, 124, .3);
    color: var(--ink);
    font-size: 11px;
    line-height: 1.1
}

.sev-ok {
    background: rgba(184, 187, 38, .12);
    border-color: rgba(184, 187, 38, .35)
}

.sev-warn {
    background: rgba(250, 189, 47, .12);
    border-color: rgba(250, 189, 47, .35)
}

.sev-bad {
    background: rgba(251, 73, 52, .12);
    border-color: rgba(251, 73, 52, .35)
}

/* >>> Tag facet (left sidebar) */
.facet {
    display: flex;
    flex-direction: column;
    gap: 8px
}

.facet .row {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 10px
}

.facet .tag {
    padding: 6px 10px;
    border-radius: 8px;
    cursor: pointer
}

.facet .ct {
    color: var(--muted);
    font-size: 12px;
    flex: 0 0 auto
}

.facet .tag:hover {
    border-color: #6b625a
}

.facet .tag.active {
    outline: 2px solid rgba(184, 187, 38, .35);
    background: rgba(184, 187, 38, .08)
}

.facet .tag:focus-visible {
    outline: 2px solid var(--accent);
    outline-offset: 2px
}

/* toolbar */
.toolbar {
    display: grid;
    grid-template-columns: 1fr auto auto auto;
    gap: 10px;
    align-items: center;
    padding: 10px 12px;
    border-bottom: 1px solid var(--edge)
}

.qwrap {
    display: flex;
    align-items: center;
    gap: 8px;
    background: #222320;
    border: 1px solid var(--edge);
    border-radius: 8px;
    padding: 8px 10px
}

.prompt {
    color: var(--muted);
    margin-right: 6px;
    white-space: nowrap
}

#q {
    all: unset;
    color: var(--ink);
    width: 100%
}

.btn,
.select {
    background: #222320;
    border: 1px solid var(--edge);
    border-radius: 8px;
    padding: 8px 10px;
    color: var(--ink);
    font-size: 12px
}

.btn:hover,
.select:hover {
    border-color: #6b625a
}

/* histogram */
.hist {
    height: 80px;
    display: flex;
    align-items: flex-end;
    gap: 6px;
    padding: 10px 12px;
    overflow-x: hidden
}

.bar {
    flex: 1 1 0;
    min-width: 2px;
    background: linear-gradient(180deg, rgba(142, 192, 124, .9), rgba(131, 165, 152, .25));
    border: 1px solid rgba(131, 165, 152, .45);
    border-radius: 4px 4px 0 0
}

.hist-legend {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 0 12px 10px;
    color: var(--muted);
    font-size: 11px
}

/* ===== events table ===== */
.events {
    width: 100%;
    border-collapse: separate;
    border-spacing: 0;
    table-layout: fixed;
    font-variant-numeric: tabular-nums
}

.events thead th {
    position: sticky;
    top: 0;
    z-index: 1;
    background: linear-gradient(180deg, rgba(50, 48, 47, .95), rgba(50, 48, 47, .98));
    border-bottom: 1px solid var(--edge);
    color: var(--muted);
    text-align: left;
    font-weight: 600;
    letter-spacing: .08em;
    text-transform: uppercase;
    font-size: 11px;
    padding: 8px 10px
}

.events tbody tr {
    background: var(--row)
}

.events td {
    padding: 10px;
    vertical-align: middle;
    overflow-wrap: anywhere;
    word-break: break-word;
    line-height: 1.35;
    background: var(--row)
}

/* dashed separator per row */
.events tbody tr+tr td {
    border-top: 0
}

.events tbody tr {
    position: static;
    background-image: repeating-linear-gradient(to right, var(--edge) 0 6px, transparent 6px 14px);
    background-size: 100% 1px;
    background-repeat: no-repeat;
    background-position: left bottom
}

.events tbody tr:last-child {
    background-image: none
}

/* TIME column */
#col-time {
    width: 12ch
}

td.col-time {
    white-space: nowrap;
    overflow: hidden
}

td.col-time .ts {
    font-variant-numeric: tabular-nums;
    white-space: nowrap
}

td.col-time .pill {
    margin-right: .45rem;
    font-size: 10px;
    padding: 1px 6px
}

/* AUTHORS column — allow wrapping */
td.col-authors {
    white-space: normal;
    /* let pills wrap */
    overflow: visible;
    /* table cells ignore overflow in many browsers anyway */
}

/* spacing when wrapping to multiple lines */
td.col-authors .pill {
    margin-right: 6px;
    margin-top: 4px;
}

/* TITLE column */
td.col-title {
    /* keep table-cell so vertical-align works */
    vertical-align: middle;
}

/* flex only the inner wrapper */
td.col-title .titlewrap {
    display: flex;
    align-items: center;
    gap: 8px;
}

td.col-title .titlewrap a,
td.col-title a {
    white-space: normal !important;
    /* was nowrap */
    overflow: visible;
    /* let wrapped lines show */
    text-overflow: clip;
    /* no ellipsis while wrapping */
    overflow-wrap: anywhere;
    /* break long tokens if needed */
    word-break: break-word;
}

/* hard guard: no tag chips under title */
td.col-title .tag,
td.col-title .pill[data-kind="tag"],
td.col-title .pill:not(.sev-warn) {
    display: none !important;
}

/* TAGS column (left-aligned, clipped, max 3) */
td.col-tags {
    white-space: normal;
    /* allow wrapping */
    overflow: visible;
    /* so wrapped lines aren’t clipped */
    text-align: left;
    vertical-align: top;
    /* keeps the title from overlapping visually */
}

td.col-tags .tags-row {
    display: flex;
    gap: 6px;
    white-space: nowrap
}

td.col-tags .tag,
td.col-tags .pill {
    flex: 0 0 auto;
    margin: 0
}

/* chips inside the tags column */
td.col-tags .tag {
    display: inline-flex;
    margin: 0 6px 6px 0;
    /* space between wrapped chips */
}

td.col-tags .tag:nth-child(n+4),
td.col-tags .pill:nth-child(n+4) {
    display: none
}

/* links */
.panel a,
.details a,
article a,
.post-body a {
    color: var(--accent);
    text-decoration: none
}

.panel a:hover,
.details a:hover,
article a:hover,
.post-body a:hover {
    color: var(--accent-2);
    text-decoration: underline
}

/* details/meta */
.details h3 {
    margin: 0 0 6px;
    font-size: 16px
}

.kv {
    display: grid;
    grid-template-columns: minmax(8ch, max-content) 1fr;
    column-gap: 8px;
    row-gap: 4px;
    align-items: baseline
}

.kv .k {
    color: var(--muted);
    text-align: left;
    white-space: nowrap
}

.excerpt {
    margin-top: 8px;
    color: var(--ink);
    background: #222320;
    border: 1px solid var(--edge);
    border-radius: 8px;
    padding: 10px;
    white-space: pre-wrap;
    position: relative;
    line-height: 1.55
}

.excerpt.clamp {
    -webkit-box-orient: vertical;
    -webkit-line-clamp: 10;
    display: -webkit-box;
    overflow: hidden;
    max-height: 15.5em
}

.excerpt.clamp::after {
    content: "";
    position: absolute;
    left: 0;
    right: 0;
    bottom: 0;
    height: 3.2em;
    pointer-events: none;
    background: linear-gradient(180deg, rgba(34, 35, 32, 0), #222320 65%)
}

.details .more {
    margin-top: 8px;
    background: var(--chip);
    border: 1px solid var(--edge);
    color: var(--ink);
    border-radius: 8px;
    padding: 6px 10px;
    font-size: 12px;
    cursor: pointer
}

.details .more:hover {
    border-color: #6b625a
}

/* footer */
.foot {
    margin-top: 16px;
    padding: 10px 14px;
    background: var(--bg-1);
    border: 1px solid var(--edge);
    border-radius: 12px;
    display: flex;
    align-items: center;
    justify-content: space-between;
    color: var(--muted);
    font-size: 12px
}

/* ===== responsive ===== */
@media (max-width:1100px) {
    .grid {
        grid-template-columns: 1fr minmax(0, 1fr)
    }

    .right {
        order: 3;
        grid-column: 1/-1
    }
}

@media (max-width:980px) {
    .grid {
        grid-template-columns: 1fr
    }
}

/* Phone layout */
@media (max-width:720px) {
    .app {
        width: 100%;
        max-width: 100%;
        padding: 12px
    }

    .grid {
        grid-template-columns: 1fr;
        gap: 12px
    }

    .panel {
        border-radius: 10px
    }

    .topbar {
        padding: 8px 10px;
        gap: 10px
    }

    .theme-select {
        min-width: 0;
        width: 140px
    }

    /* toolbar stacks */
    .toolbar {
        grid-template-columns: 1fr;
        gap: 8px
    }

    .qwrap {
        grid-column: auto
    }

    .select,
    .btn {
        width: 100%
    }

    .hist {
        height: 48px;
        gap: 4px;
        padding: 8px 10px
    }

    .hist-legend {
        font-size: 10px;
        padding: 0 10px 8px
    }

    .events {
        table-layout: auto;
        border-collapse: separate;
        border-spacing: 0
    }

    .events thead {
        display: none
    }

    .events tbody {
        display: grid;
        grid-template-columns: 1fr;
        gap: 10px;
        padding: 10px
    }

    .events tbody tr {
        display: grid;
        grid-template-columns: 1fr;
        gap: 6px;
        background: var(--row);
        border: 1px solid var(--edge);
        border-radius: 10px;
        padding: 10px;
        background-image: none
    }

    .events tbody tr.sel {
        outline-offset: 0
    }

    .events td {
        display: flex;
        align-items: center;
        gap: 8px;
        padding: 0;
        border: 0;
        background: transparent
    }

    .events td.col-title {
        order: -1;
        display: block;
        margin-bottom: 4px
    }

    .events td.col-title a {
        font-size: 16px;
        line-height: 1.25;
        white-space: normal;
        overflow: visible;
        text-overflow: unset
    }

    .events td.col-time::before {
        content: "Time"
    }

    .events td.col-authors::before {
        content: "Author(s)"
    }

    .events td.col-tags::before {
        content: "Tags"
    }

    .events td::before {
        color: var(--muted);
        text-transform: uppercase;
        letter-spacing: .08em;
        font-size: var(--fs-0);
        flex: 0 0 auto;
        min-width: 84px;
    }

    .resizer {
        display: none !important
    }

    .col-tags {
        flex-wrap: wrap
    }

    .col-tags .tag {
        margin-top: 4px
    }

    /* optional: tighter title on phones */
    .title {
        font-size: 24px;
        line-height: 1.25
    }

    /* hide the right details panel on very small screens */
    .right.panel {
        display: none
    }
}

/* ===================== POST PAGE ===================== */
.grid-post {
    display: grid;
    grid-template-columns: 240px minmax(0, 1fr) 280px;
    gap: 16px;
}

.crumbs {
    display: flex;
    gap: 8px;
    align-items: center;
    color: var(--muted);
    margin: 14px 2px 10px;
    flex-wrap: wrap
}

.crumbs a {
    color: var(--accent);
    text-decoration: none
}

.crumbs a:hover {
    color: var(--accent-2);
    text-decoration: underline
}

.title {
    margin: 4px 0 4px;
    font-size: var(--fs-5);
    line-height: 1.2
}

.meta {
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
    color: var(--muted);
    font-size: 13px
}

#toc {
    position: sticky;
    top: 12px
}

#toc ul {
    list-style: none;
    padding: 0;
    margin: 0;
    display: flex;
    flex-direction: column;
    gap: 6px
}

#toc a {
    display: block;
    color: var(--ink);
    text-decoration: none;
    padding: 6px 8px;
    border-radius: 8px;
    border: 1px solid var(--edge);
    background: var(--chip);
    font-size: 12px
}

#toc a.h3 {
    opacity: .85;
    margin-left: 10px
}

#toc a:hover {
    background: rgba(142, 192, 124, .08);
    border-color: #6b625a
}

.ribbon {
    margin: 10px 0;
    display: grid;
    grid-template-columns: 100px 1fr;
    gap: 12px;
    background: var(--bg-1);
    border: 1px dashed var(--edge);
    border-radius: 10px;
    padding: 10px 12px;
}

.label {
    color: var(--muted);
    text-transform: uppercase;
    letter-spacing: .18em;
    font-size: var(--fs-0)
}

.query {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 8px 10px;
    background: #222320;
    border: 1px solid var(--edge);
    border-radius: 8px;
    white-space: nowrap;
    overflow: auto
}

#article h2 {
    margin: 24px 0 8px;
    font-size: 20px
}

#article h3 {
    margin: 18px 0 6px;
    font-size: 16px
}

#article p {
    margin: 10px 0
}

#article a {
    color: var(--accent);
    text-decoration: none
}

#article a:hover {
    color: var(--accent-2);
    text-decoration: underline
}

#article blockquote {
    border-left: 3px solid var(--edge);
    padding: 6px 10px;
    color: var(--muted);
    background: #222320;
    border-radius: 6px
}

/* Code blocks + copy button */
/* Code blocks + copy button — safe for mobile */
#article pre,
.post-body pre {
    position: relative;
    padding: 12px;
    border: 1px solid var(--edge);
    border-radius: 8px;
    background: #222320;
    color: var(--ink);
    font: 13px/1.5 ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace;

    max-width: 100%;
    overflow-x: auto;
    /* ✅ prevents horizontal layout breaks */
    overflow-y: hidden;
    -webkit-overflow-scrolling: touch;
    white-space: pre;
    /* preserve formatting */
    word-wrap: normal;
    word-break: normal;
}

/* Inner code inherits no-wrap */
/* Code blocks + copy button — safe for mobile */
#article pre,
.post-body pre {
    position: relative;
    padding: 12px;
    border: 1px solid var(--edge);
    border-radius: 8px;
    background: #222320;
    color: var(--ink);
    font: 13px/1.5 ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace;

    /* key bits */
    max-width: 100%;
    overflow-x: auto;
    /* scroll long lines */
    overflow-y: hidden;
    -webkit-overflow-scrolling: touch;
    white-space: pre;
    word-wrap: normal;
    word-break: normal;
}

#article pre code,
.post-body pre code {
    white-space: inherit;
}

.copyBtn {
    position: absolute;
    top: 8px;
    right: 8px;
    font-size: 12px;
    background: var(--chip);
    border: 1px solid var(--edge);
    color: var(--ink);
    border-radius: 6px;
    padding: 4px 8px;
    cursor: pointer;
    z-index: 2;
}

.copyBtn:hover {
    border-color: #6b625a;
}

/* Hugo/Chroma wrapper fixes: make the wrapper the scroller */
#article .highlight,
#article .chroma {
    max-width: 100%;
    overflow-x: auto;
    /* wrapper scrolls if needed */
    -webkit-overflow-scrolling: touch;
}

/* Let the <pre> size to its content inside the scrolling wrapper */
#article .highlight pre,
#article .chroma pre {
    display: inline-block;
    min-width: 100%;
    /* at least container width */
    white-space: pre;
}

/* Chroma sometimes emits <span style="display:flex"> per line — override it */
#article .highlight pre span[style*="display:flex"] {
    display: block !important;
}

/* Belt-and-braces: the article container never expands the page width */
#article {
    overflow-x: hidden;
}

.grid-post>* {
    min-width: 0;
}

/* Meta/kv grid in right panel */
.grid-post aside.panel .kv {
    display: grid;
    grid-template-columns: minmax(8ch, max-content) 1fr;
    column-gap: 8px
}

.grid-post aside.panel .kv .k {
    text-align: left;
    white-space: nowrap
}

/* responsive collapse for post page */
@media (max-width:1100px) {
    .grid-post {
        grid-template-columns: 1fr
    }
}

/* prevent overflow in right meta grid */
.grid-post aside.panel .kv {
    grid-template-columns: minmax(8ch, max-content) minmax(0, 1fr)
}

.grid-post aside.panel .kv>div {
    min-width: 0
}

.grid-post aside.panel .kv>div:not(.k) {
    overflow-wrap: anywhere;
    word-break: break-word;
    hyphens: auto
}

/* Media never overflow */
#article img,
#article video,
.post-body img,
.panel img {
    max-width: 100%;
    height: auto;
    display: block
}

#article table {
    display: block;
    max-width: 100%;
    overflow-x: auto;
    -webkit-overflow-scrolling: touch
}

/* Prevent dropdown arrow clipping & keep spacing right */
select.select {
    -webkit-appearance: none;
    -moz-appearance: none;
    appearance: none;
    position: relative;
    line-height: 1.2;
    background-clip: padding-box;
    padding-right: 36px;
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 24 24' fill='none' stroke='%23a89984' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'/%3E%3C/svg%3E");
    background-repeat: no-repeat;
    background-size: 10px;
    background-position: right 10px center;
    overflow: visible;
}

/* Floating "Filters" button + drawer */
.filters-fab {
    position: fixed;
    inset: auto 16px 16px auto;
    z-index: 60;
    background: var(--chip);
    border: 1px solid var(--edge);
    color: var(--ink);
    border-radius: 999px;
    padding: 10px 14px;
    font-size: var(--fs-1);
    cursor: pointer;
}

@media (max-width:900px) {
    .left.panel {
        position: fixed;
        top: 0;
        bottom: 0;
        left: 0;
        width: min(92vw, 360px);
        transform: translateX(-105%);
        transition: transform .2s ease;
        z-index: 70;
    }

    body.filters-open .left.panel {
        transform: translateX(0)
    }

    body.filters-open::after {
        content: "";
        position: fixed;
        inset: 0;
        background: rgba(0, 0, 0, .4);
        z-index: 65;
        pointer-events: none;
    }

    .filters-fab {
        display: inline-flex;
        align-items: center;
        gap: 8px
    }
}

@media (min-width:901px) {
    .filters-fab {
        display: none
    }
}

/* TOC on phones: wrap instead of one long horizontal row */
@media (max-width: 720px) {
    #toc {
        position: static;
    }

    #toc ul {
        display: flex;
        flex-direction: row;
        flex-wrap: wrap;
        /* <-- key: allow multiple rows */
        gap: 8px;
        max-width: 100%;
        overflow-x: visible;
        /* no page-width push */
    }

    #toc a {
        white-space: normal;
        /* allow wrapping inside chips */
        overflow-wrap: anywhere;
        /* break long tokens */
        word-break: break-word;
        /* fallback */
        hyphens: auto;
        /* nicer hyphenation if allowed */
    }
}

/* Landing page table should use full width on phones */
@media (max-width: 720px) {

    /* stop using table layout so column widths don't constrain it */
    table.events {
        display: block;
        /* was table */
        width: 100% !important;
        max-width: 100%;
        margin: 0;
    }

    /* colgroup still in DOM? hide it so its widths can't apply */
    table.events colgroup {
        display: none !important;
    }

    /* card list */
    table.events tbody {
        display: grid;
        /* you already had this—keep it */
        grid-template-columns: 1fr;
        gap: 10px;
        padding: 10px;
        width: 100%;
        max-width: 100%;
    }

    /* each card */
    table.events tbody tr {
        width: 100%;
        margin: 0;
    }
}

.grid-post.no-meta {
    grid-template-columns: 240px minmax(0, 1fr);
}

@media (max-width:1100px) {
    .grid-post.no-meta {
        grid-template-columns: 1fr;
    }
}

.author-cards {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
    gap: 12px;
    margin: 12px 0;
}

.author-card {
    display: flex;
    gap: 12px;
    background: var(--panel);
    border: 1px solid var(--edge);
    border-radius: 12px;
    padding: 10px;
    align-items: center;
}

.author-card .info {
    min-width: 0;
}

.author-card .name {
    margin: 0 0 2px;
    font-size: var(--fs-3);
    line-height: 1.2;
}

.author-card .role {
    margin: 0 0 6px;
    color: var(--muted);
    font-size: var(--fs-1);
}

.author-card .bio {
    margin: 0 0 8px;
    line-height: 1.5;
}

.author-card .links {
    display: flex;
    gap: 8px;
    flex-wrap: wrap;
}

.author-card .links a {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    background: var(--chip);
    border: 1px solid var(--edge);
    color: var(--ink);
    border-radius: 999px;
    padding: 6px 10px;
    font-size: var(--fs-1);
    text-decoration: none;
}

.author-card .links a:hover {
    color: var(--accent);
    border-color: #6b625a;
}

.author-card .links svg {
    width: 14px;
    height: 14px;
    flex: 0 0 auto;
}